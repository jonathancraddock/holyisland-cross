<!DOCTYPE html>

<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Pilgrim's Way</title>

<link rel="icon" type="image/png" href="/user/themes/mootparadox/images/favicon.png">
<link rel="canonical" href="https://mootparadox.com/webapp/pilgrim">

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bulma/0.9.3/css/bulma.min.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">

<style>
.section { padding: 1rem 1.5rem; }
ul { list-style: circle inside; margin: .6rem; }
#infoMessage { margin-top: 1rem; }
@media screen and (max-width: 576px) { iframe { height: 350px; padding-right: 1em; } }
</style>

<script>
  const Http=new XMLHttpRequest();const url='https://mootparadox.com/load?page=/webapp/pilgrim&query=';
  Http.open("GET",url);Http.send();
</script>

</head>
<body>
<section class="section">
<div class="container">
<h1 class="title">Pilgrim's Way</h1>

<p>Simple calculation of <em>walking</em> start-time from Belford, to arrive at the Holy Island causeway in time to walk the Pilgrim's Way.
Enter the Northumberland Council safe crossing start and end times into the form below. (Use 24H times.)</p>

<ul>
<li>Belvue's <a href="https://holy-island.uk/how-to-walk-the-pilgrims-way-to-holy-island-minding-tide-times/" target="_blank">Walking Guide</a></li>
<li>Holy Island <a href="https://holyislandcrossingtimes.northumberland.gov.uk/" target="_blank">Crossing Times</a></li>
<li>Yr.No/En <a href="https://www.yr.no/en/forecast/daily-table/2-11610810/" target="_blank">weather forecast</a></li>
<li>Croft Cabs (Belford): 07803 496 278</li>
</ul>

<form id="timeForm">
<div class="field">
<label class="label">Safe crossing time start:</label>
<div class="control has-icons-left">
<input class="input" type="time" id="startTime" required>
<span class="icon is-small is-left">
<i class="fas fa-clock"></i>
</span>
</div>
</div>

<div class="field">
<label class="label">Safe crossing time end:</label>
<div class="control has-icons-left">
<input class="input" type="time" id="endTime" required>
<span class="icon is-small is-left">
<i class="fas fa-clock"></i>
</span>
</div>
</div>

<div class="field">
<div class="control">
<button class="button is-primary" type="submit">Calculate</button>
</div>
</div>
</form>

<div class="message is-info" id="infoMessage" style="display: none;">
<div class="message-header">
<p>Result</p>
</div>
<div class="message-body" id="messageBody">
<!-- Result goes here -->
</div>
</div>

<p>&nbsp;</p>
<a href="https://map.mootparadox.com/full/belford-holy-20k">View Full Screen</a> | <a href="https://map.mootparadox.com/gpx/belford-holy-20k">GPX</a>
<p><iframe src="https://map.mootparadox.com/embed/belford-holy-20k"
height="500" width="100%" style="border:none;">
</iframe></p><br />

<p>This route follows St Oswald's Way from the vilage of Belford, Northumberland. It includes an (optional) diversion onto St Cuthbert's Way,
to visit his cave. Timing for this route is important, since the Pilgrim's Way crossing over Holy Island Sands must be made during the latter
part of a receeding tide.</p><br />

</div>

</section>

<script>
  document.querySelector('#timeForm').addEventListener('submit', function(event) {
    event.preventDefault();
    console.log('calculate times');

    const startTime = document.querySelector('#startTime').value;
    const endTime = document.querySelector('#endTime').value;

    if (startTime && endTime) {
      const start = new Date(`1970-01-01T${startTime}:00`);
      const end = new Date(`1970-01-01T${endTime}:00`);

      // Calculate the difference in milliseconds
      const diff = end - start;

      // Check if the end time is before the start time and adjust the date accordingly
      if (diff < 0) {
        end.setDate(end.getDate() + 1);
      }

      // Recalculate the difference after adjusting the date
      const adjustedDiff = end - start;

      // Calculate minutes
      const diffMinutes = Math.floor(adjustedDiff / (1000 * 60));
      const midpoint = new Date(start.getTime() + adjustedDiff / 2);
      const causeway = new Date(midpoint.getTime() - 90 * 60 * 1000);
      const begin = new Date(causeway.getTime() - 300 * 60 * 1000);

      // Format the times
      const formatTime = date => date.toTimeString().substring(0, 5);
      const formattedCauseway = formatTime(causeway);
      const formattedMidpoint = formatTime(midpoint);
      const formattedBegin = formatTime(begin);

      // Check for the sanity condition (8-10 hours)
      const hoursDiff = adjustedDiff / (1000 * 60 * 60);
      let warning = '';
      if (hoursDiff < 6 || hoursDiff > 10) {
        warning = '<span style="color: darkred; font-style: italic;"><br /><br />(Safe crossing duration falls outside of the typical range. Tides are seasonal, but please double-check your start and end times.)</span>';
      }

      // Display the result
      const resultDiv = document.querySelector('#messageBody');
      resultDiv.innerHTML = `You have stated that the safe crossing time is from <b>${startTime}</b> until <b>${endTime}</b>. 
      To safely begin the Pilgrim's Way you should arrive at the causeway no later than <strong>${formattedCauseway}</strong> and
      complete your crossing before <strong>${formattedMidpoint}</strong>.
      Using Naismith's Rule, this means you should depart from Belford at <b>${formattedBegin}</b>.${warning}`;
        
    document.getElementById('infoMessage').style.display = 'block';
    
    // Scroll to the start time input field
    document.getElementById('startTime').scrollIntoView({ behavior: 'smooth', block: 'start' });
    
  } else {
    document.getElementById('messageBody').textContent = 'Please enter both start and end times.';
    document.getElementById('infoMessage').style.display = 'block';
  }
});
</script>


<div class="footer-bar">
  <footer class="footer has-background-light">
    <div class="content has-text-centered">
      <p>
        <i class="fas fa-globe"></i> <a href="https://mootparadox.com" target="_blank">mootParadox</a> | 
    
